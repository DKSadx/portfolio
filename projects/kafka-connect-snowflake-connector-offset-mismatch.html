<!DOCTYPE html><html lang="en" class="__variable_aaf875 __variable_829c8b"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/162bf645eb375add-s.p.ttf" as="font" crossorigin="" type="font/ttf"/><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://miro.medium.com/v2/resize:fit:4800/format:webp/1*kjWtWv62U_Bv-ML5KBsSvg.png"/><link rel="stylesheet" href="/_next/static/css/244d73ada5d580f4.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/4332eee14cae2b92.css" crossorigin="" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-238b1423f01223f2.js" as="script" fetchPriority="low" crossorigin=""/><script src="/_next/static/chunks/f42e5159-56eb28c3a582d27e.js" async="" crossorigin=""></script><script src="/_next/static/chunks/83-0ec6f3c254c9dbc7.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-3e66689e0eb8cf6e.js" async="" crossorigin=""></script><title>Darko Kojović | DevOps Engineer</title><meta name="description" content="Senior DevOps Engineer at Atlantbh"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta property="og:title" content="darko.sh"/><meta property="og:description" content="Senior DevOps Engineer at Atlantbh"/><meta property="og:url" content="https://darko.sh"/><meta property="og:site_name" content="Darko Kojović"/><meta property="og:locale" content="en-US"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="darko.sh"/><meta name="twitter:description" content="Senior DevOps Engineer at Atlantbh"/><link rel="shortcut icon" href="/favicon.png"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="bg-black undefined"><div class="relative min-h-screen bg-gradient-to-tl from-zinc-900 via-zinc-400/10 to-zinc-900 "><div class="bg-zinc-50 min-h-screen"><header class="relative isolate overflow-hidden bg-gradient-to-tl from-black via-zinc-900 to-black"><div class="fixed inset-x-0 top-0 z-50 backdrop-blur lg:backdrop-blur-none duration-200 border-b lg:bg-transparent bg-zinc-900/0 border-transparent"><div class="container flex flex-row-reverse items-center justify-between p-6 mx-auto"><div class="flex justify-between gap-8"><a target="_blank" href="https://ba.linkedin.com/in/darko-kojovic"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 "><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a target="_blank" href="https://github.com/DKSadx"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><a target="_blank" href="mailto:contact@darko.sh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 "><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg></a></div><a class="duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 " href="/projects"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 "><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg></a></div></div><div class="container mx-auto relative isolate overflow-hidden  py-24 sm:py-32"><div class="mx-auto max-w-7xl px-6 lg:px-8 text-center flex flex-col items-center"><div class="mx-auto max-w-2xl lg:mx-0"><h1 class="text-4xl font-bold tracking-tight text-white sm:text-6xl font-display">Kafka Connect Snowflake Connector offset mismatch fix</h1><p class="mt-6 text-lg leading-8 text-zinc-300">How to fix offset mismatch and get rid of the error: &#x27;Ignoring invalid task provided offset…&#x27; in Kafka Connect Snowflake connector.</p></div><div class="mx-auto mt-10 max-w-2xl lg:mx-0 lg:max-w-none"><div class="grid grid-cols-1 gap-y-6 gap-x-8 text-base font-semibold leading-7 text-white sm:grid-cols-2 md:flex lg:gap-x-10"><a target="_blank" href="https://dkojovic.medium.com/kafka-connect-snowflake-connector-offset-mismatch-ignoring-invalid-task-provided-offset-6fe3f5424da0">Website<!-- --> <span aria-hidden="true">→</span></a></div></div></div></div></header><article class="px-4 py-12 mx-auto prose prose-zinc prose-quoteless"><div class="mdx"><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><img class="rounded-md border border-zinc-200" alt="" src="https://miro.medium.com/v2/resize:fit:4800/format:webp/1*kjWtWv62U_Bv-ML5KBsSvg.png"/></p>
<div style="text-align:center;font-size:0.8rem;margin-top:-4%;color:#6B6B6B"><i>Kafka to Snowflake pipeline</i></div>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">If you&#x27;re here, your Kafka Connect cluster most likely stopped working and is not inserting any new messages into Snowflake. You checked the logs and saw this WARN message:</p>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="txt" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="txt" data-theme="default" style="display:grid"><span data-line=""><span style="color:#e1e4e8">[2024-04-08 16:04:23,507] WARN WorkerSinkTask{id=my-sf-connector}</span></span>
<span data-line=""><span style="color:#e1e4e8">Ignoring invalid task provided offset my-example-topic-1/OffsetAndMetadata{offset=33500, leaderEpoch=null, metadata=&#x27;&#x27;}</span></span>
<span data-line=""><span style="color:#e1e4e8">-- not yet consumed, taskOffset=33500 currentOffset=105 (org.apache.kafka.connect.runtime.WorkerSinkTask:426)</span></span></code></pre></div>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">If you got this message, someone most likely recreated the topic, changed the Kafka cluster or you migrated to a new cluster without copying the <strong>__consumer_offsets</strong> topic. These are some of the possible causes for this issue I can think of.<br/>
<!-- -->Strangely enough, this is only a <strong>WARN</strong> log level even though it means that there is an offset mismatch and messages can&#x27;t be consumed from that topic.<br/>
<!-- -->This can be dangerous since usually you don&#x27;t have alerts set up for that log level and if you have a low retention period set on your topics, there&#x27;s a high risk of losing your precious messages.<br/>
<!-- -->If you&#x27;re like me, a self proclaimed Kafka Connect expert with no proof or certification, you probably thought that this is a bit inconvenient, but an easy fix.<br/>
<!-- -->I just need to reset the offset for the specific consumer group and recreate the connector. Right?? It&#x27;s so simple!<br/>
<!-- -->So that&#x27;s exactly what I did.</p>
<h3 class="mt-8 scroll-m-20 text-2xl font-semibold tracking-tight" id="trying-to-fix-the-issue-on-the-kafka-side"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#trying-to-fix-the-issue-on-the-kafka-side"><span class="icon icon-link"></span></a>Trying to fix the issue on the Kafka side</h3>
<ol class="my-6 ml-6 list-decimal">
<li class="mt-2">I first deleted the Snowflake connector by sending a DELETE request to the Kafka Connect connector endpoint</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">curl</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">-X</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">DELETE</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">http://localhost:8083/connectors/MY_CONNECTOR_NAME</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="2">
<li class="mt-2">Then I had to stop all consumers with that specific consumer group (<code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">consumer.group.id</code>). Since you can&#x27;t change offsets with an ACTIVE/STABLE group, the group must be <strong>INACTIVE</strong>. If you have a consumer for DLQ (dead letter queue), don&#x27;t forget to turn that one off too.<br/>
<!-- -->To check if there are active consumers, you can use <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">kafka-consumer-groups.sh</code> script that comes with every Kafka installation</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">./bin/kafka-consumer-groups.sh</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--bootstrap-server</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">localhost:9092</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--command-config</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">config/client-ssl.properties</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--group</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">ExampleFooGroup</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--describe</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="3">
<li class="mt-2">After all the consumers are stopped and the group is in an INACTIVE state, I used the same script to reset the offsets</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">./bin/kafka-consumer-groups.sh</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--bootstrap-server</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">localhost:9092</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--command-config</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">config/client-ssl.properties</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--reset-offsets</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--to-earliest</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--group</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">ExampleFooGroup</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--topic</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">MyExampleTopic</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">--execute</span></span></code></pre></div>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6"><em>This will only reset offsets for <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">MyExampleTopic</code> topic, if you want to reset offsets for all topic you can use <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">--all-topics</code> flag instead of <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">--topic</code>.</em><br/>
<!-- -->4. I checked the offsets again to make sure the reset happened and recreated the connector</p>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">After doing all the steps, the issue <strong>was still there</strong> and the connector was still looking at the old offsets.<br/>
<!-- -->Since I set up and deployed several Kafka Connect clusters and am familiar with a lot of the configuration properties, especially in distributed mode, I was almost certain that the offsets were stored in the topic that was configured via the property <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">offset.storage.topic</code>.<br/>
<!-- -->I inspected the topic and, to my surprise, the topic was empty. I double checked everything in case I misconfigured or missed something but everything was looking good. After some research, I found this <a class="font-medium text-zinc-900 underline underline-offset-4" href="https://groups.google.com/g/confluent-platform/c/Zy0I-dJMydM?pli=1">Google Groups conversation</a> where it says that the <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">offset.storage.topic</code> is used only for <strong>source connectors</strong>.<br/>
<!-- -->Sink connectors use the main <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">__consumer_offsets</code> topic to store offsets which also stores all the other offsets for all consumer groups in the cluster.</p>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">I was confused since I read the documentation for that property a few times and I couldn&#x27;t recall it mentioning that the property was only for source connectors. I went to check the docs again and there was no mention that the topic is for source connectors only. Not a skill issue, just missing info in the docs; ego restored, let&#x27;s continue.</p>
<blockquote class="mt-6 border-l-2 border-zinc-300 pl-6 italic text-zinc-800 [&amp;&gt;*]:text-zinc-600">
<p class="leading-7 [&amp;:not(:first-child)]:mt-6"><em>One similar thing that is mentioned in the docs but can be easily overlooked and is not that obvious is that <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">group.id</code> for <strong>sink connectors</strong> is derived from the <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">consumer.group.id</code>.</em></p>
</blockquote>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">Anyways, I recreated the topic just to be sure but the issue was still there. So the only idea I had left was that the offsets were stored somewhere in Snowflake.</p>
<h3 class="mt-8 scroll-m-20 text-2xl font-semibold tracking-tight" id="trying-to-fix-the-issue-on-the-snowflake-side"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#trying-to-fix-the-issue-on-the-snowflake-side"><span class="icon icon-link"></span></a>Trying to fix the issue on the Snowflake side</h3>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">I opened the Snowsight console and started inspecting the tables that were mapped to the topics which were causing the offset mismatch issues. If you are not familiar with how Snowflake connectors store the data, basically it creates two columns in the specified table, one for the metadata called <em>RECORD_METADATA</em> and one for the messages called <em>RECORD_CONTENT</em>. Since <em>RECORD_CONTENT</em> are just the deserialized messages, the only interesting column that was left was <em>RECORD_METADATA</em>.<br/>
<!-- -->I inspected the column and interestingly enough, the offset was stored in the metadata!<br/>
<!-- -->Okay, okay, we&#x27;re onto something here... or at least I thought...<br/>
<!-- -->My idea was that if I clear/empty those columns, then the offsets will be gone and the connector will start from the beginning. So I did just that.</p>
<ol class="my-6 ml-6 list-decimal">
<li class="mt-2">I backed up the table in case something went wrong</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="sql" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="sql" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">create</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MY_TABLE_BACKUP</span><span style="color:#E1E4E8"> clone MY_TABLE;</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="2">
<li class="mt-2">Cleared the RECORD_METADATA column aka set it to NULL</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="sql" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="sql" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">update</span><span style="color:#E1E4E8"> MY_TABLE </span><span style="color:#F97583">set</span><span style="color:#E1E4E8"> RECORD_METADATA </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">NULL</span><span style="color:#E1E4E8">;</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="3">
<li class="mt-2">Recreated the Snowflake connector</li>
<li class="mt-2">Profit???</li>
</ol>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">Having already spent more time than I planned on this, I was eagerly waiting for the connector to come up just to see that nothing has changed, the issue was still there. 😢<br/>
<!-- -->I didn&#x27;t give up, I had one more idea to try!</p>
<h3 class="mt-8 scroll-m-20 text-2xl font-semibold tracking-tight" id="last-try-and-final-fix"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#last-try-and-final-fix"><span class="icon icon-link"></span></a>Last try and final fix</h3>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">Since I tried almost all the ideas I had, the only thing left I could think of was to recreate the Snowflake tables. I couldn&#x27;t afford to lose the data so I had to also create backups for all the tables.</p>
<ol class="my-6 ml-6 list-decimal">
<li class="mt-2">I first backed up all tables that had the offset mismatch issue</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="sql" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="sql" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">create</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MY_TABLE_BACKUP</span><span style="color:#E1E4E8"> clone MY_TABLE;</span></span>
<span data-line=""><span style="color:#F97583">create</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MY_TABLE_2_BACKUP</span><span style="color:#E1E4E8"> clone MY_TABLE_2;</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="2">
<li class="mt-2">Dropped the old tables</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="sql" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="sql" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">drop</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> MY_TABLE;</span></span>
<span data-line=""><span style="color:#F97583">drop</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> MY_TABLE_2;</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="3">
<li class="mt-2">Cloned the backup tables into new tables that had same names as the ones that were having offset issues</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4" style="background-color:#24292e" tabindex="0" data-language="sql" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="sql" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">create</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MY_TABLE</span><span style="color:#E1E4E8"> clone MY_TABLE_BACKUP;</span></span>
<span data-line=""><span style="color:#F97583">create</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">table</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">MY_TABLE_2</span><span style="color:#E1E4E8"> clone MY_TABLE_2_BACKUP;</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="4">
<li class="mt-2">Restarted the connector</li>
</ol>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">Surprisingly enough, this <strong>actually worked</strong>! 🎉🎉<br/>
<!-- -->I&#x27;m still not exactly sure why this approach fixed the issue and why none of the previous approaches did but at least there is a fix (or workaround) for it. I assume that the topics are actually mapped to Snowflake table IDs under the hood and not names so when I recreated the table, a new ID was generated and the offset was reset. But that&#x27;s just my guess.</p></div></article></div></div><script src="/_next/static/chunks/webpack-238b1423f01223f2.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/162bf645eb375add-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\n2:HL[\"/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/244d73ada5d580f4.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L4\"\n"])</script><script>self.__next_f.push([1,"5:HL[\"/_next/static/css/4332eee14cae2b92.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"6:I{\"id\":1968,\"chunks\":[\"272:static/chunks/webpack-238b1423f01223f2.js\",\"274:static/chunks/f42e5159-56eb28c3a582d27e.js\",\"83:static/chunks/83-0ec6f3c254c9dbc7.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":8321,\"chunks\":[\"272:static/chunks/webpack-238b1423f01223f2.js\",\"274:static/chunks/f42e5159-56eb28c3a582d27e.js\",\"83:static/chunks/83-0ec6f3c254c9dbc7.js\"],\"name\":\"\",\"async\":false}\n9:I{\"id\":4089,\"chunks\":[\"185:static/chunks/app/layout-a89f18ce57f495e4.js\"],\"name\":\"Analytics\",\"async\":false}\na:I{\"id\":1602,\"chunks\":["])</script><script>self.__next_f.push([1,"\"272:static/chunks/webpack-238b1423f01223f2.js\",\"274:static/chunks/f42e5159-56eb28c3a582d27e.js\",\"83:static/chunks/83-0ec6f3c254c9dbc7.js\"],\"name\":\"\",\"async\":false}\nb:I{\"id\":233,\"chunks\":[\"272:static/chunks/webpack-238b1423f01223f2.js\",\"274:static/chunks/f42e5159-56eb28c3a582d27e.js\",\"83:static/chunks/83-0ec6f3c254c9dbc7.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"4:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/244d73ada5d580f4.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L6\",null,{\"buildId\":\"33B2CmuWweTb_eAqG54DN\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/projects/kafka-connect-snowflake-connector-offset-mismatch\",\"initialTree\":[\"\",{\"children\":[\"projects\",{\"children\":[[\"slug\",\"kafka-connect-snowflake-connector-offset-mismatch\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"kafka-connect-snowflake-connector-offset-mismatch\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L7\"],\"globalErrorComponent\":\"$8\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__variable_aaf875 __variable_829c8b\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"$L9\",null,{}]}],[\"$\",\"body\",null,{\"className\":\"bg-black undefined\",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[null,[\"$\",\"div\",null,{\"className\":\"relative min-h-screen bg-gradient-to-tl from-zinc-900 via-zinc-400/10 to-zinc-900 \",\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"projects\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"projects\",\"children\",[\"slug\",\"kafka-connect-snowflake-connector-offset-mismatch\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$Lb\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lc\",\"$Ld\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"kafka-connect-snowflake-connector-offset-mismatch\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/4332eee14cae2b92.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],\"segment\":[\"slug\",\"kafka-connect-snowflake-connector-offset-mismatch\",\"d\"]},\"styles\":[]}]}],null],\"segment\":\"projects\"},\"styles\":[]}]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"e:I{\"id\":5415,\"chunks\":[\"499:static/chunks/499-57dd4957aac9efe1.js\",\"903:static/chunks/903-24266959a8966958.js\",\"101:static/chunks/app/projects/[slug]/page-4adac04e230db6ff.js\"],\"name\":\"Header\",\"async\":false}\n11:I{\"id\":918,\"chunks\":[\"499:static/chunks/499-57dd4957aac9efe1.js\",\"903:static/chunks/903-24266959a8966958.js\",\"101:static/chunks/app/projects/[slug]/page-4adac04e230db6ff.js\"],\"name\":\"\",\"async\":false}\nf:T1c07,"])</script><script>self.__next_f.push([1,"\n![](https://miro.medium.com/v2/resize:fit:4800/format:webp/1*kjWtWv62U_Bv-ML5KBsSvg.png)\n\n\u003cdiv\n  style={{\n    textAlign: 'center',\n    fontSize: '0.8rem',\n    marginTop: '-4%',\n    color: '#6B6B6B',\n  }}\n\u003e\n  \u003ci\u003eKafka to Snowflake pipeline\u003c/i\u003e\n\u003c/div\u003e\n\nIf you're here, your Kafka Connect cluster most likely stopped working and is not inserting any new messages into Snowflake. You checked the logs and saw this WARN message:\n\n```txt\n[2024-04-08 16:04:23,507] WARN WorkerSinkTask{id=my-sf-connector}\nIgnoring invalid task provided offset my-example-topic-1/OffsetAndMetadata{offset=33500, leaderEpoch=null, metadata=''}\n-- not yet consumed, taskOffset=33500 currentOffset=105 (org.apache.kafka.connect.runtime.WorkerSinkTask:426)\n```\n\nIf you got this message, someone most likely recreated the topic, changed the Kafka cluster or you migrated to a new cluster without copying the **\\_\\_consumer_offsets** topic. These are some of the possible causes for this issue I can think of.  \nStrangely enough, this is only a **WARN** log level even though it means that there is an offset mismatch and messages can't be consumed from that topic.  \nThis can be dangerous since usually you don't have alerts set up for that log level and if you have a low retention period set on your topics, there's a high risk of losing your precious messages.  \nIf you're like me, a self proclaimed Kafka Connect expert with no proof or certification, you probably thought that this is a bit inconvenient, but an easy fix.  \nI just need to reset the offset for the specific consumer group and recreate the connector. Right?? It's so simple!  \nSo that's exactly what I did.\n\n### Trying to fix the issue on the Kafka side\n\n1. I first deleted the Snowflake connector by sending a DELETE request to the Kafka Connect connector endpoint\n\n```bash\ncurl -X DELETE http://localhost:8083/connectors/MY_CONNECTOR_NAME\n```\n\n2. Then I had to stop all consumers with that specific consumer group (`consumer.group.id`). Since you can't change offsets with an ACTIVE/STABLE group, the group must be **INACTIVE**. If you have a consumer for DLQ (dead letter queue), don't forget to turn that one off too.  \n   To check if there are active consumers, you can use `kafka-consumer-groups.sh` script that comes with every Kafka installation\n\n```bash\n./bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --command-config config/client-ssl.properties --group ExampleFooGroup --describe\n```\n\n3.  After all the consumers are stopped and the group is in an INACTIVE state, I used the same script to reset the offsets\n\n```bash\n./bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 --command-config config/client-ssl.properties --reset-offsets --to-earliest --group ExampleFooGroup --topic MyExampleTopic --execute\n```\n\n_This will only reset offsets for `MyExampleTopic` topic, if you want to reset offsets for all topic you can use `--all-topics` flag instead of `--topic`._  \n4. I checked the offsets again to make sure the reset happened and recreated the connector\n\nAfter doing all the steps, the issue **was still there** and the connector was still looking at the old offsets.  \nSince I set up and deployed several Kafka Connect clusters and am familiar with a lot of the configuration properties, especially in distributed mode, I was almost certain that the offsets were stored in the topic that was configured via the property `offset.storage.topic`.  \nI inspected the topic and, to my surprise, the topic was empty. I double checked everything in case I misconfigured or missed something but everything was looking good. After some research, I found this [Google Groups conversation](https://groups.google.com/g/confluent-platform/c/Zy0I-dJMydM?pli=1) where it says that the `offset.storage.topic` is used only for **source connectors**.  \nSink connectors use the main `__consumer_offsets` topic to store offsets which also stores all the other offsets for all consumer groups in the cluster.\n\nI was confused since I read the documentation for that property a few times and I couldn't recall it mentioning that the property was only for source connectors. I went to check the docs again and there was no mention that the topic is for source connectors only. Not a skill issue, just missing info in the docs; ego restored, let's continue.\n\n\u003e _One similar thing that is mentioned in the docs but can be easily overlooked and is not that obvious is that `group.id` for **sink connectors** is derived from the `consumer.group.id`._\n\nAnyways, I recreated the topic just to be sure but the issue was still there. So the only idea I had left was that the offsets were stored somewhere in Snowflake.\n\n### Trying to fix the issue on the Snowflake side\n\nI opened the Snowsight console and started inspecting the tables that were mapped to the topics which were causing the offset mismatch issues. If you are not familiar with how Snowflake connectors store the data, basically it creates two columns in the specified table, one for the metadata called _RECORD_METADATA_ and one for the messages called _RECORD_CONTENT_. Since _RECORD_CONTENT_ are just the deserialized messages, the only interesting column that was left was _RECORD_METADATA_.  \nI inspected the column and interestingly enough, the offset was stored in the metadata!  \nOkay, okay, we're onto something here... or at least I thought...  \nMy idea was that if I clear/empty those columns, then the offsets will be gone and the connector will start from the beginning. So I did just that.\n\n1. I backed up the table in case something went wrong\n\n```sql\ncreate table MY_TABLE_BACKUP clone MY_TABLE;\n```\n\n2. Cleared the RECORD_METADATA column aka set it to NULL\n\n```sql\nupdate MY_TABLE set RECORD_METADATA = NULL;\n```\n\n3. Recreated the Snowflake connector\n4. Profit???\n\nHaving already spent more time than I planned on this, I was eagerly waiting for the connector to come up just to see that nothing has changed, the issue was still there. 😢  \nI didn't give up, I had one more idea to try!\n\n### Last try and final fix\n\nSince I tried almost all the ideas I had, the only thing left I could think of was to recreate the Snowflake tables. I couldn't afford to lose the data so I had to also create backups for all the tables.\n\n1. I first backed up all tables that had the offset mismatch issue\n\n```sql\ncreate table MY_TABLE_BACKUP clone MY_TABLE;\ncreate table MY_TABLE_2_BACKUP clone MY_TABLE_2;\n```\n\n2. Dropped the old tables\n\n```sql\ndrop table MY_TABLE;\ndrop table MY_TABLE_2;\n```\n\n3. Cloned the backup tables into new tables that had same names as the ones that were having offset issues\n\n```sql\ncreate table MY_TABLE clone MY_TABLE_BACKUP;\ncreate table MY_TABLE_2 clone MY_TABLE_2_BACKUP;\n```\n\n4. Restarted the connector\n\nSurprisingly enough, this **actually worked**! 🎉🎉  \nI'm still not exactly sure why this approach fixed the issue and why none of the previous approaches did but at least there is a fix (or workaround) for it. I assume that the topics are actually mapped to Snowflake table IDs under the hood and not names so when I recreated the table, a new ID was generated and the offset was reset. But that's just my guess.\n"])</script><script>self.__next_f.push([1,"10:T11f1f,"])</script><script>self.__next_f.push([1,"var Component=(()=\u003e{var ar=Object.create;var A=Object.defineProperty;var lr=Object.getOwnPropertyDescriptor;var ir=Object.getOwnPropertyNames;var fr=Object.getPrototypeOf,ur=Object.prototype.hasOwnProperty;var K=(i,e)=\u003e()=\u003e(e||i((e={exports:{}}).exports,e),e.exports),mr=(i,e)=\u003e{for(var _ in e)A(i,_,{get:e[_],enumerable:!0})},xe=(i,e,_,y)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let k of ir(e))!ur.call(i,k)\u0026\u0026k!==_\u0026\u0026A(i,k,{get:()=\u003ee[k],enumerable:!(y=lr(e,k))||y.enumerable});return i};var pr=(i,e,_)=\u003e(_=i!=null?ar(fr(i)):{},xe(e||!i||!i.__esModule?A(_,\"default\",{value:i,enumerable:!0}):_,i)),br=i=\u003exe(A({},\"__esModule\",{value:!0}),i);var ge=K((xr,je)=\u003e{je.exports=React});var Ee=K(G=\u003e{\"use strict\";(function(){\"use strict\";var i=ge(),e=Symbol.for(\"react.element\"),_=Symbol.for(\"react.portal\"),y=Symbol.for(\"react.fragment\"),k=Symbol.for(\"react.strict_mode\"),z=Symbol.for(\"react.profiler\"),X=Symbol.for(\"react.provider\"),H=Symbol.for(\"react.context\"),w=Symbol.for(\"react.forward_ref\"),O=Symbol.for(\"react.suspense\"),P=Symbol.for(\"react.suspense_list\"),T=Symbol.for(\"react.memo\"),B=Symbol.for(\"react.lazy\"),Te=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,Ce=\"@@iterator\";function Fe(n){if(n===null||typeof n!=\"object\")return null;var t=J\u0026\u0026n[J]||n[Ce];return typeof t==\"function\"?t:null}var j=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function m(n){{for(var t=arguments.length,o=new Array(t\u003e1?t-1:0),d=1;d\u003ct;d++)o[d-1]=arguments[d];Re(\"error\",n,o)}}function Re(n,t,o){{var d=j.ReactDebugCurrentFrame,a=d.getStackAddendum();a!==\"\"\u0026\u0026(t+=\"%s\",o=o.concat([a]));var l=o.map(function(c){return String(c)});l.unshift(\"Warning: \"+t),Function.prototype.apply.call(console[n],console,l)}}var Ie=!1,Se=!1,Ae=!1,Oe=!1,Pe=!1,Z;Z=Symbol.for(\"react.module.reference\");function Be(n){return!!(typeof n==\"string\"||typeof n==\"function\"||n===y||n===z||Pe||n===k||n===O||n===P||Oe||n===Te||Ie||Se||Ae||typeof n==\"object\"\u0026\u0026n!==null\u0026\u0026(n.$$typeof===B||n.$$typeof===T||n.$$typeof===X||n.$$typeof===H||n.$$typeof===w||n.$$typeof===Z||n.getModuleId!==void 0))}function De(n,t,o){var d=n.displayName;if(d)return d;var a=t.displayName||t.name||\"\";return a!==\"\"?o+\"(\"+a+\")\":o}function Q(n){return n.displayName||\"Context\"}function h(n){if(n==null)return null;if(typeof n.tag==\"number\"\u0026\u0026m(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof n==\"function\")return n.displayName||n.name||null;if(typeof n==\"string\")return n;switch(n){case y:return\"Fragment\";case _:return\"Portal\";case z:return\"Profiler\";case k:return\"StrictMode\";case O:return\"Suspense\";case P:return\"SuspenseList\"}if(typeof n==\"object\")switch(n.$$typeof){case H:var t=n;return Q(t)+\".Consumer\";case X:var o=n;return Q(o._context)+\".Provider\";case w:return De(n,n.render,\"ForwardRef\");case T:var d=n.displayName||null;return d!==null?d:h(n.type)||\"Memo\";case B:{var a=n,l=a._payload,c=a._init;try{return h(c(l))}catch{return null}}}return null}var x=Object.assign,U=0,ee,re,ne,te,oe,de,se;function ce(){}ce.__reactDisabledLog=!0;function Me(){{if(U===0){ee=console.log,re=console.info,ne=console.warn,te=console.error,oe=console.group,de=console.groupCollapsed,se=console.groupEnd;var n={configurable:!0,enumerable:!0,value:ce,writable:!0};Object.defineProperties(console,{info:n,log:n,warn:n,error:n,group:n,groupCollapsed:n,groupEnd:n})}U++}}function Le(){{if(U--,U===0){var n={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:x({},n,{value:ee}),info:x({},n,{value:re}),warn:x({},n,{value:ne}),error:x({},n,{value:te}),group:x({},n,{value:oe}),groupCollapsed:x({},n,{value:de}),groupEnd:x({},n,{value:se})})}U\u003c0\u0026\u0026m(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var D=j.ReactCurrentDispatcher,M;function C(n,t,o){{if(M===void 0)try{throw Error()}catch(a){var d=a.stack.trim().match(/\\n( *(at )?)/);M=d\u0026\u0026d[1]||\"\"}return`\n`+M+n}}var L=!1,F;{var Ye=typeof WeakMap==\"function\"?WeakMap:Map;F=new Ye}function ae(n,t){if(!n||L)return\"\";{var o=F.get(n);if(o!==void 0)return o}var d;L=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var l;l=D.current,D.current=null,Me();try{if(t){var c=function(){throw Error()};if(Object.defineProperty(c.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"\u0026\u0026Reflect.construct){try{Reflect.construct(c,[])}catch(N){d=N}Reflect.construct(n,[],c)}else{try{c.call()}catch(N){d=N}n.call(c.prototype)}}else{try{throw Error()}catch(N){d=N}n()}}catch(N){if(N\u0026\u0026d\u0026\u0026typeof N.stack==\"string\"){for(var s=N.stack.split(`\n`),p=d.stack.split(`\n`),f=s.length-1,u=p.length-1;f\u003e=1\u0026\u0026u\u003e=0\u0026\u0026s[f]!==p[u];)u--;for(;f\u003e=1\u0026\u0026u\u003e=0;f--,u--)if(s[f]!==p[u]){if(f!==1||u!==1)do if(f--,u--,u\u003c0||s[f]!==p[u]){var b=`\n`+s[f].replace(\" at new \",\" at \");return n.displayName\u0026\u0026b.includes(\"\u003canonymous\u003e\")\u0026\u0026(b=b.replace(\"\u003canonymous\u003e\",n.displayName)),typeof n==\"function\"\u0026\u0026F.set(n,b),b}while(f\u003e=1\u0026\u0026u\u003e=0);break}}}finally{L=!1,D.current=l,Le(),Error.prepareStackTrace=a}var E=n?n.displayName||n.name:\"\",ye=E?C(E):\"\";return typeof n==\"function\"\u0026\u0026F.set(n,ye),ye}function We(n,t,o){return ae(n,!1)}function Ve(n){var t=n.prototype;return!!(t\u0026\u0026t.isReactComponent)}function R(n,t,o){if(n==null)return\"\";if(typeof n==\"function\")return ae(n,Ve(n));if(typeof n==\"string\")return C(n);switch(n){case O:return C(\"Suspense\");case P:return C(\"SuspenseList\")}if(typeof n==\"object\")switch(n.$$typeof){case w:return We(n.render);case T:return R(n.type,t,o);case B:{var d=n,a=d._payload,l=d._init;try{return R(l(a),t,o)}catch{}}}return\"\"}var I=Object.prototype.hasOwnProperty,le={},ie=j.ReactDebugCurrentFrame;function S(n){if(n){var t=n._owner,o=R(n.type,n._source,t?t.type:null);ie.setExtraStackFrame(o)}else ie.setExtraStackFrame(null)}function $e(n,t,o,d,a){{var l=Function.call.bind(I);for(var c in n)if(l(n,c)){var s=void 0;try{if(typeof n[c]!=\"function\"){var p=Error((d||\"React class\")+\": \"+o+\" type `\"+c+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof n[c]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw p.name=\"Invariant Violation\",p}s=n[c](t,c,d,o,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(f){s=f}s\u0026\u0026!(s instanceof Error)\u0026\u0026(S(a),m(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",d||\"React class\",o,c,typeof s),S(null)),s instanceof Error\u0026\u0026!(s.message in le)\u0026\u0026(le[s.message]=!0,S(a),m(\"Failed %s type: %s\",o,s.message),S(null))}}}var qe=Array.isArray;function Y(n){return qe(n)}function Ke(n){{var t=typeof Symbol==\"function\"\u0026\u0026Symbol.toStringTag,o=t\u0026\u0026n[Symbol.toStringTag]||n.constructor.name||\"Object\";return o}}function Ge(n){try{return fe(n),!1}catch{return!0}}function fe(n){return\"\"+n}function ue(n){if(Ge(n))return m(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Ke(n)),fe(n)}var v=j.ReactCurrentOwner,ze={key:!0,ref:!0,__self:!0,__source:!0},me,pe,W;W={};function Xe(n){if(I.call(n,\"ref\")){var t=Object.getOwnPropertyDescriptor(n,\"ref\").get;if(t\u0026\u0026t.isReactWarning)return!1}return n.ref!==void 0}function He(n){if(I.call(n,\"key\")){var t=Object.getOwnPropertyDescriptor(n,\"key\").get;if(t\u0026\u0026t.isReactWarning)return!1}return n.key!==void 0}function Je(n,t){if(typeof n.ref==\"string\"\u0026\u0026v.current\u0026\u0026t\u0026\u0026v.current.stateNode!==t){var o=h(v.current.type);W[o]||(m('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(v.current.type),n.ref),W[o]=!0)}}function Ze(n,t){{var o=function(){me||(me=!0,m(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",t))};o.isReactWarning=!0,Object.defineProperty(n,\"key\",{get:o,configurable:!0})}}function Qe(n,t){{var o=function(){pe||(pe=!0,m(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",t))};o.isReactWarning=!0,Object.defineProperty(n,\"ref\",{get:o,configurable:!0})}}var er=function(n,t,o,d,a,l,c){var s={$$typeof:e,type:n,key:t,ref:o,props:c,_owner:l};return s._store={},Object.defineProperty(s._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(s,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:d}),Object.defineProperty(s,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.freeze\u0026\u0026(Object.freeze(s.props),Object.freeze(s)),s};function rr(n,t,o,d,a){{var l,c={},s=null,p=null;o!==void 0\u0026\u0026(ue(o),s=\"\"+o),He(t)\u0026\u0026(ue(t.key),s=\"\"+t.key),Xe(t)\u0026\u0026(p=t.ref,Je(t,a));for(l in t)I.call(t,l)\u0026\u0026!ze.hasOwnProperty(l)\u0026\u0026(c[l]=t[l]);if(n\u0026\u0026n.defaultProps){var f=n.defaultProps;for(l in f)c[l]===void 0\u0026\u0026(c[l]=f[l])}if(s||p){var u=typeof n==\"function\"?n.displayName||n.name||\"Unknown\":n;s\u0026\u0026Ze(c,u),p\u0026\u0026Qe(c,u)}return er(n,s,p,a,d,v.current,c)}}var V=j.ReactCurrentOwner,be=j.ReactDebugCurrentFrame;function g(n){if(n){var t=n._owner,o=R(n.type,n._source,t?t.type:null);be.setExtraStackFrame(o)}else be.setExtraStackFrame(null)}var $;$=!1;function q(n){return typeof n==\"object\"\u0026\u0026n!==null\u0026\u0026n.$$typeof===e}function _e(){{if(V.current){var n=h(V.current.type);if(n)return`\n\nCheck the render method of \\``+n+\"`.\"}return\"\"}}function nr(n){{if(n!==void 0){var t=n.fileName.replace(/^.*[\\\\\\/]/,\"\"),o=n.lineNumber;return`\n\nCheck your code at `+t+\":\"+o+\".\"}return\"\"}}var he={};function tr(n){{var t=_e();if(!t){var o=typeof n==\"string\"?n:n.displayName||n.name;o\u0026\u0026(t=`\n\nCheck the top-level render call using \u003c`+o+\"\u003e.\")}return t}}function Ne(n,t){{if(!n._store||n._store.validated||n.key!=null)return;n._store.validated=!0;var o=tr(t);if(he[o])return;he[o]=!0;var d=\"\";n\u0026\u0026n._owner\u0026\u0026n._owner!==V.current\u0026\u0026(d=\" It was passed a child from \"+h(n._owner.type)+\".\"),g(n),m('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',o,d),g(null)}}function ke(n,t){{if(typeof n!=\"object\")return;if(Y(n))for(var o=0;o\u003cn.length;o++){var d=n[o];q(d)\u0026\u0026Ne(d,t)}else if(q(n))n._store\u0026\u0026(n._store.validated=!0);else if(n){var a=Fe(n);if(typeof a==\"function\"\u0026\u0026a!==n.entries)for(var l=a.call(n),c;!(c=l.next()).done;)q(c.value)\u0026\u0026Ne(c.value,t)}}}function or(n){{var t=n.type;if(t==null||typeof t==\"string\")return;var o;if(typeof t==\"function\")o=t.propTypes;else if(typeof t==\"object\"\u0026\u0026(t.$$typeof===w||t.$$typeof===T))o=t.propTypes;else return;if(o){var d=h(t);$e(o,n.props,\"prop\",d,n)}else if(t.PropTypes!==void 0\u0026\u0026!$){$=!0;var a=h(t);m(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",a||\"Unknown\")}typeof t.getDefaultProps==\"function\"\u0026\u0026!t.getDefaultProps.isReactClassApproved\u0026\u0026m(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function dr(n){{for(var t=Object.keys(n.props),o=0;o\u003ct.length;o++){var d=t[o];if(d!==\"children\"\u0026\u0026d!==\"key\"){g(n),m(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",d),g(null);break}}n.ref!==null\u0026\u0026(g(n),m(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),g(null))}}function sr(n,t,o,d,a,l){{var c=Be(n);if(!c){var s=\"\";(n===void 0||typeof n==\"object\"\u0026\u0026n!==null\u0026\u0026Object.keys(n).length===0)\u0026\u0026(s+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var p=nr(a);p?s+=p:s+=_e();var f;n===null?f=\"null\":Y(n)?f=\"array\":n!==void 0\u0026\u0026n.$$typeof===e?(f=\"\u003c\"+(h(n.type)||\"Unknown\")+\" /\u003e\",s=\" Did you accidentally export a JSX literal instead of a component?\"):f=typeof n,m(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",f,s)}var u=rr(n,t,o,a,l);if(u==null)return u;if(c){var b=t.children;if(b!==void 0)if(d)if(Y(b)){for(var E=0;E\u003cb.length;E++)ke(b[E],n);Object.freeze\u0026\u0026Object.freeze(b)}else m(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ke(b,n)}return n===y?dr(u):or(u),u}}var cr=sr;G.Fragment=y,G.jsxDEV=cr})()});var ve=K((gr,Ue)=\u003e{\"use strict\";Ue.exports=Ee()});var kr={};mr(kr,{default:()=\u003eNr,frontmatter:()=\u003e_r});var r=pr(ve()),_r={title:\"Kafka Connect Snowflake Connector offset mismatch fix\",description:\"How to fix offset mismatch and get rid of the error: 'Ignoring invalid task provided offset\\u2026' in Kafka Connect Snowflake connector.\",date:\"2024-04-12\",url:\"https://dkojovic.medium.com/kafka-connect-snowflake-connector-offset-mismatch-ignoring-invalid-task-provided-offset-6fe3f5424da0\",published:!0};function we(i){let e=Object.assign({p:\"p\",img:\"img\",div:\"div\",pre:\"pre\",code:\"code\",span:\"span\",strong:\"strong\",br:\"br\",h3:\"h3\",a:\"a\",ol:\"ol\",li:\"li\",em:\"em\",blockquote:\"blockquote\"},i.components);return(0,r.jsxDEV)(r.Fragment,{children:[(0,r.jsxDEV)(e.p,{children:(0,r.jsxDEV)(e.img,{src:\"https://miro.medium.com/v2/resize:fit:4800/format:webp/1*kjWtWv62U_Bv-ML5KBsSvg.png\",alt:\"\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:9,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,r.jsxDEV)(\"div\",{style:{textAlign:\"center\",fontSize:\"0.8rem\",marginTop:\"-4%\",color:\"#6B6B6B\"},children:(0,r.jsxDEV)(\"i\",{children:\"Kafka to Snowflake pipeline\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:19,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:\"If you're here, your Kafka Connect cluster most likely stopped working and is not inserting any new messages into Snowflake. You checked the logs and saw this WARN message:\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:22,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"txt\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"txt\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,r.jsxDEV)(e.span,{style:{color:\"#e1e4e8\"},children:\"[2024-04-08 16:04:23,507] WARN WorkerSinkTask{id=my-sf-connector}\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this),`\n`,(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,r.jsxDEV)(e.span,{style:{color:\"#e1e4e8\"},children:\"Ignoring invalid task provided offset my-example-topic-1/OffsetAndMetadata{offset=33500, leaderEpoch=null, metadata=''}\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:(0,r.jsxDEV)(e.span,{style:{color:\"#e1e4e8\"},children:\"-- not yet consumed, taskOffset=33500 currentOffset=105 (org.apache.kafka.connect.runtime.WorkerSinkTask:426)\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:3,columnNumber:20},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:3,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:24,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[\"If you got this message, someone most likely recreated the topic, changed the Kafka cluster or you migrated to a new cluster without copying the \",(0,r.jsxDEV)(e.strong,{children:\"__consumer_offsets\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:30,columnNumber:146},this),\" topic. These are some of the possible causes for this issue I can think of.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:30,columnNumber:246},this),`\n`,\"Strangely enough, this is only a \",(0,r.jsxDEV)(e.strong,{children:\"WARN\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:31,columnNumber:34},this),\" log level even though it means that there is an offset mismatch and messages can't be consumed from that topic.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:31,columnNumber:154},this),`\n`,\"This can be dangerous since usually you don't have alerts set up for that log level and if you have a low retention period set on your topics, there's a high risk of losing your precious messages.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:32,columnNumber:197},this),`\n`,\"If you're like me, a self proclaimed Kafka Connect expert with no proof or certification, you probably thought that this is a bit inconvenient, but an easy fix.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:33,columnNumber:161},this),`\n`,\"I just need to reset the offset for the specific consumer group and recreate the connector. Right?? It's so simple!\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:34,columnNumber:116},this),`\n`,\"So that's exactly what I did.\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:30,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.h3,{id:\"trying-to-fix-the-issue-on-the-kafka-side\",children:[(0,r.jsxDEV)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#trying-to-fix-the-issue-on-the-kafka-side\",children:(0,r.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this),\"Trying to fix the issue on the Kafka side\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:37,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"I first deleted the Snowflake connector by sending a DELETE request to the Kafka Connect connector endpoint\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:39,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:39,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"curl\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:144},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"-X\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:181},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:219},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"DELETE\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:256},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:298},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"http://localhost:8083/connectors/MY_CONNECTOR_NAME\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:335},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:41,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"2\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:[\"Then I had to stop all consumers with that specific consumer group (\",(0,r.jsxDEV)(e.code,{children:\"consumer.group.id\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:45,columnNumber:72},this),\"). Since you can't change offsets with an ACTIVE/STABLE group, the group must be \",(0,r.jsxDEV)(e.strong,{children:\"INACTIVE\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:45,columnNumber:172},this),\". If you have a consumer for DLQ (dead letter queue), don't forget to turn that one off too.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:45,columnNumber:276},this),`\n`,\"To check if there are active consumers, you can use \",(0,r.jsxDEV)(e.code,{children:\"kafka-consumer-groups.sh\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:46,columnNumber:56},this),\" script that comes with every Kafka installation\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:45,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:45,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"./bin/kafka-consumer-groups.sh\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:170},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--bootstrap-server\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:207},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:261},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"localhost:9092\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:298},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:348},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--command-config\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:385},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:437},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"config/client-ssl.properties\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:474},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:538},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--group\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:575},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:618},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"ExampleFooGroup\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:655},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:706},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--describe\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:743},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:48,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"3\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"After all the consumers are stopped and the group is in an INACTIVE state, I used the same script to reset the offsets\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:52,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:52,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"./bin/kafka-consumer-groups.sh\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:170},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--bootstrap-server\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:207},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:261},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"localhost:9092\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:298},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:348},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--command-config\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:385},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:437},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"config/client-ssl.properties\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:474},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:538},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--reset-offsets\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:575},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:626},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--to-earliest\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:663},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:712},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--group\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:749},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:792},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"ExampleFooGroup\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:829},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:880},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--topic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:917},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:960},this),(0,r.jsxDEV)(e.span,{style:{color:\"#9ECBFF\"},children:\"MyExampleTopic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:997},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1047},this),(0,r.jsxDEV)(e.span,{style:{color:\"#79B8FF\"},children:\"--execute\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1084},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:54,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[(0,r.jsxDEV)(e.em,{children:[\"This will only reset offsets for \",(0,r.jsxDEV)(e.code,{children:\"MyExampleTopic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:35},this),\" topic, if you want to reset offsets for all topic you can use \",(0,r.jsxDEV)(e.code,{children:\"--all-topics\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:114},this),\" flag instead of \",(0,r.jsxDEV)(e.code,{children:\"--topic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:145},this),\".\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:1},this),(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:156},this),`\n`,\"4. I checked the offsets again to make sure the reset happened and recreated the connector\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:58,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[\"After doing all the steps, the issue \",(0,r.jsxDEV)(e.strong,{children:\"was still there\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:61,columnNumber:38},this),\" and the connector was still looking at the old offsets.\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:61,columnNumber:113},this),`\n`,\"Since I set up and deployed several Kafka Connect clusters and am familiar with a lot of the configuration properties, especially in distributed mode, I was almost certain that the offsets were stored in the topic that was configured via the property \",(0,r.jsxDEV)(e.code,{children:\"offset.storage.topic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:62,columnNumber:252},this),\".\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:62,columnNumber:275},this),`\n`,\"I inspected the topic and, to my surprise, the topic was empty. I double checked everything in case I misconfigured or missed something but everything was looking good. After some research, I found this \",(0,r.jsxDEV)(e.a,{href:\"https://groups.google.com/g/confluent-platform/c/Zy0I-dJMydM?pli=1\",children:\"Google Groups conversation\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:63,columnNumber:204},this),\" where it says that the \",(0,r.jsxDEV)(e.code,{children:\"offset.storage.topic\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:63,columnNumber:324},this),\" is used only for \",(0,r.jsxDEV)(e.strong,{children:\"source connectors\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:63,columnNumber:364},this),\".\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:63,columnNumber:386},this),`\n`,\"Sink connectors use the main \",(0,r.jsxDEV)(e.code,{children:\"__consumer_offsets\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:64,columnNumber:30},this),\" topic to store offsets which also stores all the other offsets for all consumer groups in the cluster.\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:61,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:\"I was confused since I read the documentation for that property a few times and I couldn't recall it mentioning that the property was only for source connectors. I went to check the docs again and there was no mention that the topic is for source connectors only. Not a skill issue, just missing info in the docs; ego restored, let's continue.\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.blockquote,{children:[`\n`,(0,r.jsxDEV)(e.p,{children:(0,r.jsxDEV)(e.em,{children:[\"One similar thing that is mentioned in the docs but can be easily overlooked and is not that obvious is that \",(0,r.jsxDEV)(e.code,{children:\"group.id\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:113},this),\" for \",(0,r.jsxDEV)(e.strong,{children:\"sink connectors\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:128},this),\" is derived from the \",(0,r.jsxDEV)(e.code,{children:\"consumer.group.id\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:168},this),\".\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:3},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:3},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:68,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:\"Anyways, I recreated the topic just to be sure but the issue was still there. So the only idea I had left was that the offsets were stored somewhere in Snowflake.\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:70,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.h3,{id:\"trying-to-fix-the-issue-on-the-snowflake-side\",children:[(0,r.jsxDEV)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#trying-to-fix-the-issue-on-the-snowflake-side\",children:(0,r.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this),\"Trying to fix the issue on the Snowflake side\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:72,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[\"I opened the Snowsight console and started inspecting the tables that were mapped to the topics which were causing the offset mismatch issues. If you are not familiar with how Snowflake connectors store the data, basically it creates two columns in the specified table, one for the metadata called \",(0,r.jsxDEV)(e.em,{children:\"RECORD_METADATA\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:299},this),\" and one for the messages called \",(0,r.jsxDEV)(e.em,{children:\"RECORD_CONTENT\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:349},this),\". Since \",(0,r.jsxDEV)(e.em,{children:\"RECORD_CONTENT\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:373},this),\" are just the deserialized messages, the only interesting column that was left was \",(0,r.jsxDEV)(e.em,{children:\"RECORD_METADATA\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:472},this),\".\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:490},this),`\n`,\"I inspected the column and interestingly enough, the offset was stored in the metadata!\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:75,columnNumber:88},this),`\n`,\"Okay, okay, we're onto something here... or at least I thought...\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:76,columnNumber:66},this),`\n`,\"My idea was that if I clear/empty those columns, then the offsets will be gone and the connector will start from the beginning. So I did just that.\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:74,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"I backed up the table in case something went wrong\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:79,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:79,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"sql\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"create\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:146},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:183},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:224},this),(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"MY_TABLE_BACKUP\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:261},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" clone MY_TABLE;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:312},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:81,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"2\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"Cleared the RECORD_METADATA column aka set it to NULL\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:85,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:85,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"sql\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"update\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" MY_TABLE \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:146},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"set\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:192},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" RECORD_METADATA \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:231},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"=\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:284},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:321},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"NULL\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:358},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:398},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:87,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"3\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"Recreated the Snowflake connector\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:91,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.li,{children:\"Profit???\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:92,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:91,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[\"Having already spent more time than I planned on this, I was eagerly waiting for the connector to come up just to see that nothing has changed, the issue was still there. \\u{1F622}\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:94,columnNumber:174},this),`\n`,\"I didn't give up, I had one more idea to try!\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:94,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.h3,{id:\"last-try-and-final-fix\",children:[(0,r.jsxDEV)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#last-try-and-final-fix\",children:(0,r.jsxDEV)(e.span,{className:\"icon icon-link\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this),\"Last try and final fix\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:97,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:\"Since I tried almost all the ideas I had, the only thing left I could think of was to recreate the Snowflake tables. I couldn't afford to lose the data so I had to also create backups for all the tables.\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:99,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"I first backed up all tables that had the offset mismatch issue\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:101,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:101,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"sql\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"create\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:146},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:183},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:224},this),(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"MY_TABLE_BACKUP\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:261},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" clone MY_TABLE;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:312},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this),`\n`,(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"create\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:20},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:62},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:99},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:140},this),(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"MY_TABLE_2_BACKUP\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:177},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" clone MY_TABLE_2;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:230},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:103,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"2\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"Dropped the old tables\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:108,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:108,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"sql\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"drop\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:144},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:181},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" MY_TABLE;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:222},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this),`\n`,(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"drop\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:20},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:60},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:97},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" MY_TABLE_2;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:138},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:110,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"3\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"Cloned the backup tables into new tables that had same names as the ones that were having offset issues\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:115,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:115,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,r.jsxDEV)(e.pre,{style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",children:(0,r.jsxDEV)(e.code,{\"data-language\":\"sql\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"create\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:104},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:146},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:183},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:224},this),(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"MY_TABLE\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:261},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" clone MY_TABLE_BACKUP;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:305},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:85},this),`\n`,(0,r.jsxDEV)(e.span,{\"data-line\":\"\",children:[(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"create\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:20},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:62},this),(0,r.jsxDEV)(e.span,{style:{color:\"#F97583\"},children:\"table\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:99},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:140},this),(0,r.jsxDEV)(e.span,{style:{color:\"#B392F0\"},children:\"MY_TABLE_2\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:177},this),(0,r.jsxDEV)(e.span,{style:{color:\"#E1E4E8\"},children:\" clone MY_TABLE_2_BACKUP;\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:223},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:2,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:79},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:117,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.ol,{start:\"4\",children:[`\n`,(0,r.jsxDEV)(e.li,{children:\"Restarted the connector\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:122,columnNumber:1},this),`\n`]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:122,columnNumber:1},this),`\n`,(0,r.jsxDEV)(e.p,{children:[\"Surprisingly enough, this \",(0,r.jsxDEV)(e.strong,{children:\"actually worked\"},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:124,columnNumber:27},this),\"! \\u{1F389}\\u{1F389}\",(0,r.jsxDEV)(e.br,{},void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:124,columnNumber:52},this),`\n`,\"I'm still not exactly sure why this approach fixed the issue and why none of the previous approaches did but at least there is a fix (or workaround) for it. I assume that the topics are actually mapped to Snowflake table IDs under the hood and not names so when I recreated the table, a new ID was generated and the offset was reset. But that's just my guess.\"]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:124,columnNumber:1},this)]},void 0,!0,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\",lineNumber:1,columnNumber:1},this)}function hr(i={}){let{wrapper:e}=i.components||{};return e?(0,r.jsxDEV)(e,Object.assign({},i,{children:(0,r.jsxDEV)(we,i,void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this)}),void 0,!1,{fileName:\"/Users/darko/personal_projects/darko.sh/content/projects/_mdx_bundler_entry_point-57c7ccdd-e2f3-4b52-9e2f-3feb68281ede.mdx\"},this):we(i)}var Nr=hr;return br(kr);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"])</script><script>self.__next_f.push([1,"d:[\"$\",\"div\",null,{\"className\":\"bg-zinc-50 min-h-screen\",\"children\":[[\"$\",\"$Le\",null,{\"project\":{\"published\":true,\"title\":\"Kafka Connect Snowflake Connector offset mismatch fix\",\"description\":\"How to fix offset mismatch and get rid of the error: 'Ignoring invalid task provided offset…' in Kafka Connect Snowflake connector.\",\"date\":\"2024-04-12T00:00:00.000Z\",\"url\":\"https://dkojovic.medium.com/kafka-connect-snowflake-connector-offset-mismatch-ignoring-invalid-task-provided-offset-6fe3f5424da0\",\"body\":{\"raw\":\"$f\",\"code\":\"$10\"},\"_id\":\"projects/kafka-connect-snowflake-connector-offset-mismatch.mdx\",\"_raw\":{\"sourceFilePath\":\"projects/kafka-connect-snowflake-connector-offset-mismatch.mdx\",\"sourceFileName\":\"kafka-connect-snowflake-connector-offset-mismatch.mdx\",\"sourceFileDir\":\"projects\",\"contentType\":\"mdx\",\"flattenedPath\":\"projects/kafka-connect-snowflake-connector-offset-mismatch\"},\"type\":\"Project\",\"path\":\"/projects/kafka-connect-snowflake-connector-offset-mismatch\",\"slug\":\"kafka-connect-snowflake-connector-offset-mismatch\"}}],[\"$\",\"article\",null,{\"className\":\"px-4 py-12 mx-auto prose prose-zinc prose-quoteless\",\"children\":[\"$\",\"div\",null,{\"className\":\"mdx\",\"children\":[[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"$\",\"img\",null,{\"className\":\"rounded-md border border-zinc-200\",\"alt\":\"\",\"src\":\"https://miro.medium.com/v2/resize:fit:4800/format:webp/1*kjWtWv62U_Bv-ML5KBsSvg.png\"}]}],\"\\n\",[\"$\",\"div\",null,{\"style\":{\"textAlign\":\"center\",\"fontSize\":\"0.8rem\",\"marginTop\":\"-4%\",\"color\":\"#6B6B6B\"},\"children\":[\"$\",\"i\",null,{\"children\":\"Kafka to Snowflake pipeline\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"If you're here, your Kafka Connect cluster most likely stopped working and is not inserting any new messages into Snowflake. You checked the logs and saw this WARN message:\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"txt\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"txt\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#e1e4e8\"},\"children\":\"[2024-04-08 16:04:23,507] WARN WorkerSinkTask{id=my-sf-connector}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#e1e4e8\"},\"children\":\"Ignoring invalid task provided offset my-example-topic-1/OffsetAndMetadata{offset=33500, leaderEpoch=null, metadata=''}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#e1e4e8\"},\"children\":\"-- not yet consumed, taskOffset=33500 currentOffset=105 (org.apache.kafka.connect.runtime.WorkerSinkTask:426)\"}]}]]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"If you got this message, someone most likely recreated the topic, changed the Kafka cluster or you migrated to a new cluster without copying the \",[\"$\",\"strong\",null,{\"children\":\"__consumer_offsets\"}],\" topic. These are some of the possible causes for this issue I can think of.\",[\"$\",\"br\",null,{}],\"\\n\",\"Strangely enough, this is only a \",[\"$\",\"strong\",null,{\"children\":\"WARN\"}],\" log level even though it means that there is an offset mismatch and messages can't be consumed from that topic.\",[\"$\",\"br\",null,{}],\"\\n\",\"This can be dangerous since usually you don't have alerts set up for that log level and if you have a low retention period set on your topics, there's a high risk of losing your precious messages.\",[\"$\",\"br\",null,{}],\"\\n\",\"If you're like me, a self proclaimed Kafka Connect expert with no proof or certification, you probably thought that this is a bit inconvenient, but an easy fix.\",[\"$\",\"br\",null,{}],\"\\n\",\"I just need to reset the offset for the specific consumer group and recreate the connector. Right?? It's so simple!\",[\"$\",\"br\",null,{}],\"\\n\",\"So that's exactly what I did.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"mt-8 scroll-m-20 text-2xl font-semibold tracking-tight\",\"id\":\"trying-to-fix-the-issue-on-the-kafka-side\",\"children\":[[\"$\",\"$L11\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#trying-to-fix-the-issue-on-the-kafka-side\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Trying to fix the issue on the Kafka side\"]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"I first deleted the Snowflake connector by sending a DELETE request to the Kafka Connect connector endpoint\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"curl\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"-X\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"DELETE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"http://localhost:8083/connectors/MY_CONNECTOR_NAME\"}]]}]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"2\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":[\"Then I had to stop all consumers with that specific consumer group (\",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"consumer.group.id\"}],\"). Since you can't change offsets with an ACTIVE/STABLE group, the group must be \",[\"$\",\"strong\",null,{\"children\":\"INACTIVE\"}],\". If you have a consumer for DLQ (dead letter queue), don't forget to turn that one off too.\",[\"$\",\"br\",null,{}],\"\\n\",\"To check if there are active consumers, you can use \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"kafka-consumer-groups.sh\"}],\" script that comes with every Kafka installation\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"./bin/kafka-consumer-groups.sh\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--bootstrap-server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"localhost:9092\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--command-config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"config/client-ssl.properties\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--group\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"ExampleFooGroup\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--describe\"}]]}]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"3\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"After all the consumers are stopped and the group is in an INACTIVE state, I used the same script to reset the offsets\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"./bin/kafka-consumer-groups.sh\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--bootstrap-server\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"localhost:9092\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--command-config\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"config/client-ssl.properties\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--reset-offsets\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--to-earliest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--group\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"ExampleFooGroup\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--topic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"MyExampleTopic\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"--execute\"}]]}]}]}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[[\"$\",\"em\",null,{\"children\":[\"This will only reset offsets for \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"MyExampleTopic\"}],\" topic, if you want to reset offsets for all topic you can use \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"--all-topics\"}],\" flag instead of \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"--topic\"}],\".\"]}],[\"$\",\"br\",null,{}],\"\\n\",\"4. I checked the offsets again to make sure the reset happened and recreated the connector\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"After doing all the steps, the issue \",[\"$\",\"strong\",null,{\"children\":\"was still there\"}],\" and the connector was still looking at the old offsets.\",[\"$\",\"br\",null,{}],\"\\n\",\"Since I set up and deployed several Kafka Connect clusters and am familiar with a lot of the configuration properties, especially in distributed mode, I was almost certain that the offsets were stored in the topic that was configured via the property \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"offset.storage.topic\"}],\".\",[\"$\",\"br\",null,{}],\"\\n\",\"I inspected the topic and, to my surprise, the topic was empty. I double checked everything in case I misconfigured or missed something but everything was looking good. After some research, I found this \",[\"$\",\"$L11\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4\",\"href\":\"https://groups.google.com/g/confluent-platform/c/Zy0I-dJMydM?pli=1\",\"children\":\"Google Groups conversation\"}],\" where it says that the \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"offset.storage.topic\"}],\" is used only for \",[\"$\",\"strong\",null,{\"children\":\"source connectors\"}],\".\",[\"$\",\"br\",null,{}],\"\\n\",\"Sink connectors use the main \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"__consumer_offsets\"}],\" topic to store offsets which also stores all the other offsets for all consumer groups in the cluster.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"I was confused since I read the documentation for that property a few times and I couldn't recall it mentioning that the property was only for source connectors. I went to check the docs again and there was no mention that the topic is for source connectors only. Not a skill issue, just missing info in the docs; ego restored, let's continue.\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"mt-6 border-l-2 border-zinc-300 pl-6 italic text-zinc-800 [\u0026\u003e*]:text-zinc-600\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"$\",\"em\",null,{\"children\":[\"One similar thing that is mentioned in the docs but can be easily overlooked and is not that obvious is that \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"group.id\"}],\" for \",[\"$\",\"strong\",null,{\"children\":\"sink connectors\"}],\" is derived from the \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"consumer.group.id\"}],\".\"]}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"Anyways, I recreated the topic just to be sure but the issue was still there. So the only idea I had left was that the offsets were stored somewhere in Snowflake.\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"mt-8 scroll-m-20 text-2xl font-semibold tracking-tight\",\"id\":\"trying-to-fix-the-issue-on-the-snowflake-side\",\"children\":[[\"$\",\"$L11\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#trying-to-fix-the-issue-on-the-snowflake-side\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Trying to fix the issue on the Snowflake side\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"I opened the Snowsight console and started inspecting the tables that were mapped to the topics which were causing the offset mismatch issues. If you are not familiar with how Snowflake connectors store the data, basically it creates two columns in the specified table, one for the metadata called \",[\"$\",\"em\",null,{\"children\":\"RECORD_METADATA\"}],\" and one for the messages called \",[\"$\",\"em\",null,{\"children\":\"RECORD_CONTENT\"}],\". Since \",[\"$\",\"em\",null,{\"children\":\"RECORD_CONTENT\"}],\" are just the deserialized messages, the only interesting column that was left was \",[\"$\",\"em\",null,{\"children\":\"RECORD_METADATA\"}],\".\",[\"$\",\"br\",null,{}],\"\\n\",\"I inspected the column and interestingly enough, the offset was stored in the metadata!\",[\"$\",\"br\",null,{}],\"\\n\",\"Okay, okay, we're onto something here... or at least I thought...\",[\"$\",\"br\",null,{}],\"\\n\",\"My idea was that if I clear/empty those columns, then the offsets will be gone and the connector will start from the beginning. So I did just that.\"]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"I backed up the table in case something went wrong\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"MY_TABLE_BACKUP\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" clone MY_TABLE;\"}]]}]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"2\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Cleared the RECORD_METADATA column aka set it to NULL\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"update\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" MY_TABLE \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"set\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" RECORD_METADATA \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"NULL\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\";\"}]]}]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"3\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Recreated the Snowflake connector\"}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Profit???\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"Having already spent more time than I planned on this, I was eagerly waiting for the connector to come up just to see that nothing has changed, the issue was still there. 😢\",[\"$\",\"br\",null,{}],\"\\n\",\"I didn't give up, I had one more idea to try!\"]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"mt-8 scroll-m-20 text-2xl font-semibold tracking-tight\",\"id\":\"last-try-and-final-fix\",\"children\":[[\"$\",\"$L11\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#last-try-and-final-fix\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Last try and final fix\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"Since I tried almost all the ideas I had, the only thing left I could think of was to recreate the Snowflake tables. I couldn't afford to lose the data so I had to also create backups for all the tables.\"}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"I first backed up all tables that had the offset mismatch issue\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"MY_TABLE_BACKUP\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" clone MY_TABLE;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"MY_TABLE_2_BACKUP\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" clone MY_TABLE_2;\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"2\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Dropped the old tables\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"drop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" MY_TABLE;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"drop\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" MY_TABLE_2;\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"3\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Cloned the backup tables into new tables that had same names as the ones that were having offset issues\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"sql\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"MY_TABLE\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" clone MY_TABLE_BACKUP;\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"create\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"table\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"MY_TABLE_2\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" clone MY_TABLE_2_BACKUP;\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"4\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Restarted the connector\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"Surprisingly enough, this \",[\"$\",\"strong\",null,{\"children\":\"actually worked\"}],\"! 🎉🎉\",[\"$\",\"br\",null,{}],\"\\n\",\"I'm still not exactly sure why this approach fixed the issue and why none of the previous approaches did but at least there is a fix (or workaround) for it. I assume that the topics are actually mapped to Snowflake table IDs under the hood and not names so when I recreated the table, a new ID was generated and the offset was reset. But that's just my guess.\"]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Darko Kojović | DevOps Engineer\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Senior DevOps Engineer at Atlantbh\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"darko.sh\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Senior DevOps Engineer at Atlantbh\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://darko.sh\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"Darko Kojović\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:locale\",\"content\":\"en-US\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"darko.sh\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"Senior DevOps Engineer at Atlantbh\"}],[\"$\",\"link\",\"15\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.png\"}],[\"$\",\"meta\",\"16\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"c:null\n"])</script></body></html>